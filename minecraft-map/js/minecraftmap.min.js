/**** @Preserve

 The Ink & Parchment Map v1.7.3

 Copyright 2015 Glenn Fisher

 This is an unofficial mapping system for Minecraft. It is neither produced nor
 endorsed by Mojang.

 Licenced under GPL licence, version 3 or later
 https://www.gnu.org/copyleft/gpl.html

 Note that other files in this project have their own licence, see \licence.md
*****/
var MinecraftMap;!function(e){"use strict";function t(t){e.isString(t)?e.gMapDataUriDefault=t:alert("SetDefaultSrc() was passed a non-string value")}function i(t){e.isString(t)?e.gHrefTargetDefault=t:alert("SetDefaultHrefTarget() was passed a non-string value")}function a(e,t){var i,a=null;try{CSV.DETECT_TYPES=!1,CSV.TRIM_UNQUOTED_VALUES=!0,CSV.EXPAND_QUOTED_NEWLINES=!0,i=CSV.parse(t)[0]}catch(t){alert("Could not parse comma seperated values for entry/line "+e.toString()+": "+t)}var r=i[0];if("?"==r[r.length-1]&&(r=r.substring(0,r.length-1)),r in s){var o=s[r],h=parseInt(i[1]),l=parseInt(i[2]),c=parseInt(i[6]);isNaN(h)||isNaN(l)||(a=new g(h,l,o,n(i[3]),n(i[4]),n(i[5]),c))}return a}function n(t){var i=t;if(e.isString(t)&&t.length>=2&&'"'==t[0]&&'"'==t[t.length-1]){var a=jQuery.parseJSON('{"value":'+t+"}");i=a.value}return i}function r(e,t){var i=new l,n=[],r=e.split("\n"),o=0;for(o=0;o<r.length;o++){var s=r[o];if("/"!=s[0]){var h=a(o+1,r[o]);h instanceof g?n.push(h):i.AssignFromRow(r[o])}}t(i,n)}function o(t,i){function n(t){var i=t,a=e.trim(t),n=a.length>=2&&'"'==a[0]&&'"'==a[a.length-1];return n||(a.indexOf(",")>=0||a.indexOf('"')>=0)&&(i='"'+a.replace(/"/g,'""')+'"'),i}var r=new l,o=[],s=jQuery.parseHTML(t),h=0;$(s).find("tr").each(function(){var e="";h++,$(this).find("td").each(function(){e+=n(this.textContent)+","});var t=a(h,e);t instanceof g?o.push(t):r.AssignFromRow(e)}),h=0,$(s).find("ul, ol").each(function(){$(this).find("li").each(function(){h++;var e=a(h,this.textContent);e instanceof g?o.push(e):r.AssignFromRow(this.textContent)})}),i(r,o)}var s={Village:{iconIndex:0,name:"Plains Village",href:"http://minecraft.gamepedia.com/Village#Plains"},DesertVillage:{iconIndex:1,name:"Desert village",href:"http://minecraft.gamepedia.com/Village#Desert"},SavannahVillage:{iconIndex:0,name:"Savannah village",href:"http://minecraft.gamepedia.com/Village#Savannah"},WitchHut:{iconIndex:3,name:"Witch's hut",href:"http://minecraft.gamepedia.com/Generated_structures#Witch_Huts"},JungleTemple:{iconIndex:4,name:"Jungle temple",href:"http://minecraft.gamepedia.com/Jungle_temple"},DesertTemple:{iconIndex:5,name:"Desert temple",href:"http://minecraft.gamepedia.com/Desert_temple"},NetherFortress:{iconIndex:6,name:"Nether Fortress",href:"http://minecraft.gamepedia.com/Nether_Fortress"},NetherPortal:{iconIndex:7,name:"Portal",href:"http://minecraft.gamepedia.com/Nether_Portal"},Forest:{iconIndex:28,name:"Forest",href:"http://minecraft.gamepedia.com/Biome#Forest"},FlowerForest:{iconIndex:26,name:"Flower forest",href:"http://minecraft.gamepedia.com/Flower_forest"},MushroomIsland:{iconIndex:29,name:"Mushroom island",href:"http://minecraft.gamepedia.com/Mushroom_Island"},Horse:{iconIndex:34,name:"",href:"http://minecraft.gamepedia.com/Horse"},Wolf:{iconIndex:35,name:"",href:"http://minecraft.gamepedia.com/Wolf"},Dragon:{iconIndex:36,name:"",href:""},SeaMonster:{iconIndex:46,name:"",href:""},Ship:{iconIndex:38,name:"",href:""},IcePlainsSpikes:{iconIndex:47,name:"Ice plains spikes",href:"http://minecraft.gamepedia.com/Ice_Plains_Spikes"},Spawn:{iconIndex:40,name:"Spawn",href:""},PlayerStructure:{iconIndex:8,name:"",href:""},PlayerCastle:{iconIndex:9,name:"",href:""},PlayerHouse:{iconIndex:10,name:"",href:""},PlayerFarm:{iconIndex:14,name:"Farm",href:""},PlayerMachine:{iconIndex:12,name:"",href:""},EnchantingRoom:{iconIndex:44,name:"",href:"http://minecraft.gamepedia.com/Enchantment_Table"},Label:{iconIndex:-1,name:"",href:""},FenceOverlay:{iconIndex:13,name:"",href:""},IslandOverlay:{iconIndex:30,name:"",href:""}};!function(e){e[e.none=0]="none",e[e.smart=1]="smart",e[e.all=2]="all"}(e.LabellingStyle||(e.LabellingStyle={}));e.LabellingStyle;!function(e){e[e.normal=0]="normal",e[e.suppress=1]="suppress",e[e.always=2]="always"}(e.LabellingStyleOverride||(e.LabellingStyleOverride={}));var h=e.LabellingStyleOverride;e.IconBoundsInformation={0:{width:14,height:14,yOffset:-1,pixelArt:!0},1:{width:14,height:16,yOffset:-1,pixelArt:!0},2:{width:12,height:20,yOffset:0,pixelArt:!0},3:{width:14,height:20,yOffset:-4,pixelArt:!0},4:{width:16,height:17,yOffset:-2,pixelArt:!0},5:{width:10,height:17,yOffset:0,pixelArt:!0},6:{width:10,height:14,yOffset:-2,pixelArt:!0},7:{width:10,height:13,yOffset:-1,pixelArt:!0},8:{width:10,height:10,yOffset:0,pixelArt:!0},9:{width:10,height:14,yOffset:-2,pixelArt:!0},10:{width:12,height:11,yOffset:0,pixelArt:!0},11:{width:15,height:8,yOffset:0,pixelArt:!0},12:{width:10,height:18,yOffset:-4,pixelArt:!0},13:{width:0,height:8,yOffset:5,pixelArt:!0},14:{width:16,height:16,yOffset:-1,pixelArt:!0},15:{width:12,height:13,yOffset:0,pixelArt:!0},16:{width:10,height:10,yOffset:0,pixelArt:!0},17:{width:10,height:10,yOffset:0,pixelArt:!0},18:{width:10,height:10,yOffset:0,pixelArt:!0},19:{width:12,height:12,yOffset:0,pixelArt:!0},20:{width:16,height:16,yOffset:0,pixelArt:!1},21:{width:4,height:18,yOffset:0,pixelArt:!1},22:{width:14,height:24,yOffset:-4,pixelArt:!1},23:{width:15,height:16,yOffset:-1,pixelArt:!0},24:{width:15,height:16,yOffset:-1,pixelArt:!0},25:{width:15,height:16,yOffset:-1,pixelArt:!0},26:{width:20,height:22,yOffset:0,pixelArt:!1},27:{width:20,height:18,yOffset:-3,pixelArt:!1},28:{width:24,height:22,yOffset:-4,pixelArt:!1},29:{width:17,height:16,yOffset:-1,pixelArt:!1},30:{width:0,height:16,yOffset:8,pixelArt:!1},31:{width:30,height:18,yOffset:0,pixelArt:!1},32:{width:30,height:20,yOffset:-1,pixelArt:!1},33:{width:18,height:16,yOffset:-1,pixelArt:!1},34:{width:18,height:17,yOffset:0,pixelArt:!1},35:{width:17,height:13,yOffset:0,pixelArt:!1},36:{width:30,height:26,yOffset:1,pixelArt:!1},37:{width:27,height:27,yOffset:1,pixelArt:!1},38:{width:29,height:30,yOffset:0,pixelArt:!1},39:{width:20,height:27,yOffset:-2,pixelArt:!1},40:{width:14,height:12,yOffset:0,pixelArt:!1},41:{width:18,height:16,yOffset:0,pixelArt:!1},42:{width:14,height:22,yOffset:-4,pixelArt:!1},43:{width:14,height:16,yOffset:-1,pixelArt:!0},44:{width:14,height:16,yOffset:-1,pixelArt:!0},45:{width:11,height:13,yOffset:0,pixelArt:!0},46:{width:28,height:18,yOffset:1,pixelArt:!1},47:{width:28,height:30,yOffset:1,pixelArt:!1}};var l=function(){function t(){this.MissingSrcMessageDisplayed=!1,this.GoogleSrcLooksLikeDoc=!1}return t.prototype.SetDefaults=function(t,i){var a=0;"HideLabelsAbove"in this||(this.HideLabelsAbove=a),"ShowLabelsBelow"in this||(this.ShowLabelsBelow=3),"MapRange"in this||(this.MapRange=e.cMapRangeDefault),"Title"in this||(this.Title="Map of the Overworld"),"Blurb"in this||(this.Blurb="Use up/down or mousewheel to zoom, drag to scroll"),"CustomIconsUri"in this||(this.CustomIconsUri=""),"X"in this||(this.X=0),"Z"in this||(this.Z=0),"ShowOrigin"in this||(this.ShowOrigin=!0),"ShowScale"in this||(this.ShowScale=!0),"ShowCoordinates"in this||(this.ShowCoordinates=!1),"DisableCoordinates"in this||(this.DisableCoordinates=!1),"OceanTheme"in this||(this.OceanTheme="BlueCoastline"),"HardCoastlines"in this||(this.HardCoastlines=!1),"OceanMapUri"in this||(this.OceanMapUri="")},t.prototype.AssignFrom=function(e){"MapDataUri"in e&&(this.MapDataUri=e.MapDataUri),"HideLabelsAbove"in e&&(this.HideLabelsAbove=e.HideLabelsAbove),"ShowLabelsBelow"in e&&(this.ShowLabelsBelow=e.ShowLabelsBelow),"MapRange"in e&&(this.MapRange=e.MapRange),"Title"in e&&(this.Title=e.Title),"Blurb"in e&&(this.Blurb=e.Blurb),"CustomIconsUri"in e&&(this.CustomIconsUri=e.CustomIconsUri),"X"in e&&(this.X=e.X),"Z"in e&&(this.Z=e.Z),"ShowOrigin"in e&&(this.ShowOrigin=e.ShowOrigin),"ShowScale"in e&&(this.ShowScale=e.ShowScale),"ShowCoordinates"in e&&(this.ShowCoordinates=e.ShowCoordinates),"DisableCoordinates"in e&&(this.DisableCoordinates=e.DisableCoordinates),"OceanTheme"in e&&(this.OceanTheme=e.OceanTheme),"HardCoastlines"in e&&(this.HardCoastlines=e.HardCoastlines),"OceanMapUri"in e&&(this.OceanMapUri=e.OceanMapUri)},t.prototype.AssignFromRow=function(t){var i=t.indexOf("=");if(i>0){var a=e.trim(t.substring(0,i)).toLowerCase(),r=e.trim(t.slice(i+1));if("z"==a){var o=parseInt(r);isNaN(o)||(this.Z=o)}else if("x"==a){var s=parseInt(r);isNaN(s)||(this.X=s)}else if("hidelabelsabove"==a){var h=parseInt(r);isNaN(h)||(this.HideLabelsAbove=h)}else if("showlabelsbelow"==a){var l=parseInt(r);isNaN(l)||(this.ShowLabelsBelow=l)}else if("range"==a){var c=parseInt(r);isNaN(c)||(this.MapRange=c)}else"title"==a&&e.isString(r)?this.Title=n(r):"blurb"==a&&e.isString(r)?this.Blurb=n(r):"icons"==a&&e.isString(r)?this.CustomIconsUri=n(r):"googleicons"==a&&e.isString(r)?this.CustomIconsUri="https://googledrive.com/host/"+n(r):"showorigin"==a&&e.isString(r)?this.ShowOrigin=e.stringToBool(r):"showscale"==a&&e.isString(r)?this.ShowScale=e.stringToBool(r):"showcoordinates"==a&&e.isString(r)?this.ShowCoordinates=e.stringToBool(r):"disablecoordinates"==a&&e.isString(r)?this.DisableCoordinates=e.stringToBool(r):"oceantheme"==a&&e.isString(r)?(this.OceanTheme=n(r),this.HardCoastlines=this.OceanTheme.lastIndexOf("hard")==this.OceanTheme.length-4&&this.OceanTheme.length>3,this.HardCoastlines&&(this.OceanTheme=this.OceanTheme.substr(0,this.OceanTheme.length-4))):"oceansrc"==a&&e.isString(r)?this.OceanMapUri=n(r):"oceangooglesrc"==a&&e.isString(r)&&(this.OceanMapUri="https://googledrive.com/host/"+n(r))}},t.prototype.AssignFromUrl=function(t){var i=e.parseURL(t);if(void 0!==Object.keys&&0==Object.keys(i.params).length&&location.host.indexOf("googledrive.com")>20&&(alert('no "src=" url was specified to scrape the location data from.\n\n(On the off-chance you did specify a src parameter and it\'s gone, then Google Drive could be experiencing problems again:\nSee http://buildingwithblocks.info/googlebug for more details)'),this.MissingSrcMessageDisplayed=!0),"hidelabelsabove"in i.params&&(this.HideLabelsAbove=i.params.hidelabelsabove),"showlabelsbelow"in i.params&&(this.ShowLabelsBelow=i.params.showlabelsbelow),"range"in i.params&&(this.MapRange=i.params.range),"title"in i.params&&e.isString(i.params.title)&&(this.Title=decodeURIComponent(i.params.title.replace(/\+/g," "))),"blurb"in i.params&&e.isString(i.params.blurb)&&(this.Blurb=decodeURIComponent(i.params.blurb.replace(/\+/g," "))),"x"in i.params){var a=parseInt(i.params.x);isNaN(a)||(this.X=a)}if("z"in i.params){var n=parseInt(i.params.z);isNaN(n)||(this.Z=n)}"hideorigin"in i.params&&(this.ShowOrigin=!1),"hidescale"in i.params&&(this.ShowScale=!1),"showorigin"in i.params&&e.isString(i.params.showorigin)&&(this.ShowOrigin=e.stringToBool(i.params.showorigin)),"showscale"in i.params&&e.isString(i.params.showscale)&&(this.ShowScale=e.stringToBool(i.params.showscale)),"showcoordinates"in i.params&&e.isString(i.params.showcoordinates)&&(this.ShowCoordinates=e.stringToBool(i.params.showcoordinates)),"icons"in i.params&&e.isString(i.params.icons)&&(this.CustomIconsUri=i.params.icons),"googleicons"in i.params&&e.isString(i.params.googleicons)&&(this.CustomIconsUri="https://googledrive.com/host/"+i.params.googleicons),"src"in i.params&&e.isString(i.params.src)&&(this.MapDataUri=decodeURIComponent(i.params.src)),"googlesrc"in i.params&&e.isString(i.params.googlesrc)&&(0==i.params.googlesrc.toLowerCase().indexOf("http")?this.MapDataUri=i.params.googlesrc:(this.MapDataUri="https://googledrive.com/host/"+i.params.googlesrc,i.params.googlesrc.length>40&&(this.GoogleSrcLooksLikeDoc=!0))),"oceansrc"in i.params&&e.isString(i.params.oceansrc)&&(this.OceanMapUri=decodeURIComponent(i.params.oceansrc)),"oceangooglesrc"in i.params&&e.isString(i.params.oceangooglesrc)&&(0==i.params.oceangooglesrc.toLowerCase().indexOf("http")?this.OceanMapUri=i.params.oceangooglesrc:this.OceanMapUri="https://googledrive.com/host/"+i.params.oceangooglesrc),"oceantheme"in i.params&&e.isString(i.params.oceantheme)&&(this.OceanTheme=i.params.oceantheme,this.HardCoastlines=this.OceanTheme.lastIndexOf("hard")==this.OceanTheme.length-4&&this.OceanTheme.length>3,this.HardCoastlines&&(this.OceanTheme=this.OceanTheme.substr(0,this.OceanTheme.length-4)))},t.prototype.GetXTranslationFunction=function(e){var t=e/2,i=this.X,a=this.MapRange;return function(e){return(e-i)*t/a+t}},t.prototype.GetZTranslationFunction=function(e){var t=e/2,i=this.Z,a=this.MapRange;return function(e){return(e-i)*t/a+t}},t}();e.MapConfiguration=l;var c=function(){function t(e,t){void 0===t&&(t=h.normal),this.text=e,this.displayOverride=t,this.suppress=this.displayOverride===h.suppress,this.always=this.displayOverride===h.always}return t.prototype.toString=function(){return this.text},t.parse=function(i){var a=new t(i),n=e.trim(i);return n.length>=2&&(n[0]==e.cLabel_DontDrawChar&&n[n.length-1]==e.cLabel_DontDrawChar?a=new t(n.substring(1,n.length-1),h.suppress):n[0]==e.cLabel_AlwaysDrawChar&&n[n.length-1]==e.cLabel_AlwaysDrawChar&&(a=new t(n.substring(1,n.length-1),h.always))),a},t}();e.SuppressableLabel=c;var g=function(){function t(e,t,i,a,n,r,o){this.x=e,this.z=t,this.type=i,this.labelOverride=c.parse(a),this.hrefOverride=r,this.iconIndexOverride=o,this.owner=c.parse(n)}return t.prototype.getHrefAndTarget=function(t){return new d("-"==this.hrefOverride?"":e.isEmpty(this.hrefOverride)&&t!==!0?this.type.href:this.hrefOverride)},t.prototype.getLabel=function(){return e.isEmpty(this.labelOverride.text)?this.type.name:this.labelOverride.text},t.prototype.getIconIndex=function(){return isNaN(this.iconIndexOverride)||this.iconIndexOverride<0?this.type.iconIndex:this.iconIndexOverride},t.prototype.getAlt=function(){var t=this.getLabel();return e.isEmpty(t)&&!e.isEmpty(this.owner.text)&&(t=this.owner.text),t},t}();e.Location=g;var d=function(){function t(t){if(this.target=e.gHrefTargetDefault,e.isEmpty(t))this.href="";else if("_"==t[0]){var i=t.indexOf("_",1);i>0?(this.target=t.substring(0,i),this.href=t.substring(i+1)):this.href=t}else this.href=t}return t}(),f=function(){function e(e,t,i,a){this.equals=function(e){return this.x1==e.x1&&this.y1==e.y1&&this.x2==e.x2&&this.y2==e.y2},this.x1=Math.min(e,i),this.y1=Math.min(t,a),this.x2=Math.max(e,i),this.y2=Math.max(t,a),this.width=1+i-e,this.height=1+a-t}return e.prototype.stroke=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),e.strokeRect(this.x1+t,this.y1+i,this.width,this.height)},e.prototype.copy=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),new e(this.x1+t,this.y1+i,this.x2+t,this.y2+i)},e.prototype.intersects=function(e){return this.x2>e.x1&&this.x1<e.x2&&this.y2>e.y1&&this.y1<e.y2},e}();e.Rectangle=f,e.SetDefaultSrc=t,e.SetDefaultHrefTarget=i,e.parseTextLocations=r,e.parseHtmlLocations=o}(MinecraftMap||(MinecraftMap={}));var MinecraftMap;!function(e){"use strict";function t(t,a,n,r,o,h,l){var c=document.createElement("canvas");c.width=n,c.height=r;var g;g=t<o.HideLabelsAbove?e.LabellingStyle.none:t>=o.ShowLabelsBelow?e.LabellingStyle.all:e.LabellingStyle.smart,s(c,o,h,g);var d=i(a,n,r,o,h),f=$(document.createElement("img")).css("display","block")[0],p=$.Deferred();f.onload=function(){p.resolve()},f.src=c.toDataURL("image/png"),f.useMap="#"+d;var m=document.getElementById(a);$(f).appendTo(m),$.when(p).done(l)}function i(t,i,o,s,h){var l=t+"-areamap",c=i>o?i:o,g=s.GetXTranslationFunction(c),d=s.GetZTranslationFunction(c),f=document.createElement("map");f.name=l;var p;for(p=0;p<h.length;++p){var m=h[p],u=m.getHrefAndTarget(),w=!1,v=document.createElement("area");e.isEmpty(u.href)||(v.href=u.href,v.target=u.target,w=!0);var y=r(m,s.ShowCoordinates&&!s.DisableCoordinates);y.length>0&&($(v).mouseover(a(y)),$(v).mouseout(n),w=!0),w&&(v.shape="circle",v.coords=g(m.x)+","+d(m.z)+","+e.cClickRadius*e.gLocationIconScale,v.alt=m.getAlt(),$(v).appendTo(f))}return $(f).appendTo(document.getElementById(t)),l}function a(e){return function(t){$("#locationDesc").empty(),$("#locationDesc").append(e),$("#hoverFrame").removeClass("hidden-hoverFrame")}}function n(e){$("#hoverFrame").addClass("hidden-hoverFrame"),$("#locationDesc").empty()}function r(t,i){var a="",n=t.getLabel();e.isNotEmptyString(n)&&(n=o(e.trim(n)));var r=t.owner.text;e.isNotEmptyString(r)&&(r=o(e.trim(r)));var s=e.isNotEmptyString(r)?n.indexOf(r):-1,h='<span class="locationHoverOwner">'+r+"</span>",l=!0;if(e.isNotEmptyString(n)&&n!=r){var c=n;s>=0&&(c=n.substring(0,s)+h+n.substring(s+r.length),l=!1),c='<span class="locationHoverPlacename">'+c+"</span>",a=c,e.isNotEmptyString(r)&&l&&(a+="<br/>")}return e.isNotEmptyString(r)&&l&&(a+=h),e.isNotEmptyString(a)&&i&&(a+='<span class="locationHoverCoordinates"><br/>'+t.x+", "+t.z+"</span>"),e.isNotEmptyString(a)&&e.isNotEmptyString(t.getHrefAndTarget(!0).href)&&(a+='<div style="height: 11px"><img src="img/link.png" height="7" style="vertical-align: middle"></div>'),a}function o(e){return e.replace("\n"," ").replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function s(t,i,a,n){function r(e){return e.split(/\r\n|\n|\r/)}function o(e,t,i){var a;"BoundsAtOrigin"in e?a=e.BoundsAtOrigin:(a=s(0,i,t,1),e.BoundsAtOrigin=a);var n,r=[];for(n=0;n<a.length;n++)r[n]=a[n].copy(S(e.x),O(e.z));return r}function s(t,i,a,n){var o=[];if(n<0||n>0||(n=0),!e.isEmpty(a)){var s,h=1*e.gLocationFontScale,l=r(a);for(s=0;s<l.length;s++){var c=v.measureText(l[s]).width,g=v.measureText(e.trimLeft(l[s])).width,d=v.measureText(e.trimRight(l[s])).width,f=c-g,p=c-d,m=t-(c-1)/2,u=i+h;o[s]=new e.Rectangle(m+f-n,u-w-n,m+(c-1)-p+n,u+n),h+=w}}return o}function l(t,i,a){var n=0;if(!e.isEmpty(a)){var o,s=r(a);for(o=0;o<s.length;o++)v.fillText(s[o],t-v.measureText(s[o]).width/2,i+n),n+=w}}function g(t){var i;if(isNaN(t)||t<0)i={width:0,height:0,yOffset:0,pixelArt:!0};else{var a=e.IconBoundsInformation[t];i=void 0===a?{width:20,height:20,yOffset:0,pixelArt:!0}:1==e.gLocationIconScale?a:{width:a.width,height:a.height,yOffset:a.yOffset,pixelArt:a.pixelArt}}return i.width*=e.gLocationIconScale,i.height*=e.gLocationIconScale,i.yOffset*=e.gLocationIconScale,i}function d(t,i,a,n){var r=[];if(isNaN(t)||t<0);else{var o=g(t);if(0!=o.width&&0!=o.height){var s=i-o.width/2,h=a+o.yOffset-o.height/2;r[0]=new e.Rectangle(s,h,s+o.width-1,h+o.height-1)}}return r}function f(t,i,a,n){!isNaN(t)&&t>=0&&(t>=e.cCustomIconIndexStart?null!==e.gCustomIcons&&c(v,e.gCustomIcons,t-e.cCustomIconIndexStart,!0,i,a,n):c(v,x,t,e.IconBoundsInformation[t].pixelArt,i,a,n))}function p(t,i){var a="",r=S(t.x),s=O(t.z),h=Math.max(y/128,8*e.gLocationIconScale);if(r>h&&s>h&&r<y-h&&s<y-h){if(e.isEmpty(t.labelOverride.text)||t.labelOverride.suppress?e.isEmpty(t.owner.text)||t.owner.suppress||(a+=t.owner.text):a+=t.labelOverride.text,e.isEmpty(t.owner.text)||a.indexOf(t.owner.text)!=-1||t.owner.suppress||(a+="\n("+t.owner.text+")"),!e.isEmpty(a)&&i==M.Captions&&n!=e.LabellingStyle.none){var c,p=t.getIconIndex();if(isNaN(p)||p<0)c=3*e.gLocationFontScale;else{var m=g(p);c=e.cCaptionSpacer_vertical*e.gLocationFontScale+m.yOffset+m.height/2}var u=!0,w=t.labelOverride.always||t.owner.always;if(n==e.LabellingStyle.smart){var x,b=o(t,a,c);for(x=0;x<b.length;x++){var C,A=b[x];for(C=0;C<I.length;C++)if(A.intersects(I[C])){var T=d(t.getIconIndex(),r,s,0);if(0==T.length||!T[0].equals(I[C])){u=!1;break}}if(!u)break}(u||w)&&(I=I.concat(b))}if((u||w)&&l(r,s+c,a),e.cShowBoundingBoxes){v.lineWidth=1,v.strokeStyle="#0000FF";var C,L=o(t,a,0);for(C=0;C<L.length;C++)L[C].stroke(v)}}i==M.Masks&&f(t.getIconIndex(),!0,r,s),e.isEmpty(a)?i==M.UncaptionedIcons&&f(t.getIconIndex(),!1,r,s):i==M.CaptionedIcons&&f(t.getIconIndex(),!1,r,s)}}function m(){var t=8*e.gLocationIconScale,i=Math.round(S(0)),a=Math.round(O(0));v.lineWidth=2*e.gLocationIconScale,v.strokeStyle="#6e5830",v.moveTo(i,a-t),v.lineTo(i,a+t),v.moveTo(i-t,a),v.lineTo(i+t,a),v.stroke()}function u(){var a=$("#map-background").width(),n=2*i.MapRange/a,r=Math.round(n).toString(),o=t.width/a,s=5,h=Math.round(6*o),c=Math.round(($("#map-background").height()-6)*o),g=Math.round(.4*o);v.lineWidth=2*e.gLocationFontScale,v.strokeStyle="#6e5830",v.moveTo(h,c),v.lineTo(h+Math.round(o*s),c),v.lineTo(h+Math.round(o*s),c+g),v.moveTo(h,c-g),v.lineTo(h,c+g),v.moveTo(h+Math.round(o),c-g),v.lineTo(h+Math.round(o),c),v.stroke();var d=c-g-4,f=c+g+w;l(h+o,d,r),l(h,f,"0"),l(h+o*s,f,Math.round(n*s).toString())}var w=10*e.gLocationFontScale,v=t.getContext("2d"),y=t.width>t.height?t.width:t.height,x=document.getElementById("map-tileset"),S=i.GetXTranslationFunction(y),O=i.GetZTranslationFunction(y),I=[],M={Masks:0,Origin:1,Captions:2,UncaptionedIcons:3,CaptionedIcons:4,Scale:5,First:0,Last:5},b=document.getElementById("map-background");h(v),v.drawImage(b,0,0,t.width,t.height),v.lineWidth=1,v.strokeStyle="#FF00FF";var C;for(C=0;C<a.length;C++){var A=a[C],T=d(A.getIconIndex(),S(A.x),O(A.z),0);T.length>0&&(I[I.length]=T[0],e.cShowBoundingBoxes&&T[0].stroke(v))}v.font=w+"px Arial",v.font=w+"px 'Merienda', Arial, sans-serif",e.gLocationFontScale>1&&(v.fillStyle="#553A24");var L;for(L=M.First;L<=M.Last;L++)if(L==M.Origin)i.ShowOrigin&&m();else if(L==M.Scale)i.ShowScale&&u();else if(L==M.Captions){var D;for(D=0;D<a.length;D++)p(a[D],L)}else{var D;for(D=a.length-1;D>=0;D--)p(a[D],L)}}function h(e,t){void 0===t&&(t=!0),e.mozImageSmoothingEnabled=!t,e.webkitImageSmoothingEnabled=!t,e.msImageSmoothingEnabled=!t,e.imageSmoothingEnabled=!t}function l(t){if(null!=e.gOceanMapImage){var i=document.getElementById("map-background"),a=e.renderOcean(t,i,e.gOceanMapImage);i.src=a.toDataURL("image/png")}}function c(t,i,a,n,r,o,s){var l=i.height/2,c=l/2*e.gLocationIconScale;1!=e.gLocationIconScale&&h(t,n&&!r),t.drawImage(i,a*l,r?l:0,l,l,o-c,s-c,l*e.gLocationIconScale,l*e.gLocationIconScale)}e.createMapImageInDiv=t,e.PreRender=l}(MinecraftMap||(MinecraftMap={}));var MinecraftMap;!function(e){"use strict";function t(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var i=t.getContext("2d");return i.drawImage(e,0,0),t}var i=function(){function e(e,t,i,a){this.R=e,this.G=t,this.B=i,this.A=void 0===a?255:a}return e.prototype.Blend=function(t,i){i=i<0?0:i>1?1:i;var a=1-i;return new e(Math.round(t.R*i+this.R*a),Math.round(t.G*i+this.G*a),Math.round(t.B*i+this.B*a))},e.prototype.MatchesRGB=function(e,t,i){return e==this.R&&t==this.G&&i==this.B},e.prototype.Matches=function(t){return t instanceof e&&t.R==this.R&&t.G==this.G&&t.B==this.B},e}();e.RGB=i,e.cloneCanvas=t}(MinecraftMap||(MinecraftMap={}));var MinecraftMap;!function(e){"use strict";function t(e){return!e||0===e.length}function i(e){return"string"==typeof e||e instanceof String}function a(e){return("string"==typeof e||e instanceof String)&&e.length>0}function n(e){return"function"==typeof e}function r(e){switch(l(e).toLowerCase()){case"true":case"on":case"yes":case"1":return!0;case"false":case"off":case"no":case"0":case null:return!1;default:return Boolean(e)}}function o(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}function s(e){return n(e.trimRight)?e.trimRight():e.replace(/\s+$/,"")}function h(e){return n(e.trimLeft)?e.trimLeft():e.replace(/^\s+/,"")}function l(e){return n(e.trim)?e.trim():e.replace(/^\s+|\s+$/g,"")}function c(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:parseInt(t.port),query:t.search,params:function(){for(var e,i={},a=t.search.replace(/^\?/,"").split("&"),n=a.length,r=0;r<n;r++)a[r]&&(e=a[r].split("="),i[e[0]]=e[1]);return i}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}}function g(e){return!!e.complete&&("undefined"==typeof e.naturalWidth||0!=e.naturalWidth)}e.isEmpty=t,e.isString=i,e.isNotEmptyString=a,e.isFunction=n,e.stringToBool=r,e.imageToCanvas=o,e.trimRight=s,e.trimLeft=h,e.trim=l,e.parseURL=c,e.isImageOk=g}(MinecraftMap||(MinecraftMap={}));var MinecraftMap;!function(e){"use strict";function t(t,r,o){if(0==o.width)return alert("Invalid ocean mask - width 0"),e.imageToCanvas(r);var l=o.width/2,c=o.height/2,g=Math.round(2*t.MapRange/s),d=Math.round(l+(t.X-t.MapRange)/s),f=Math.round(c+(t.Z-t.MapRange)/s),p=d<0?0:d,m=f<0?0:f,u=g-(p-d),w=g-(m-f);u=u>o.width?o.width:u,w=w>o.height?o.height:w;var v=r.width/g,y=Math.round((p-d)*v),x=Math.round((m-f)*v),S=Math.round(u*v),O=Math.round(w*v),I=S*h,M=O*h,b=document.createElement("canvas");b.width=I,b.height=M;var C=b.getContext("2d");C.drawImage(o,p,m,u,w,0,0,I,M);var A=t.OceanTheme.toLowerCase();return"darkseas"==A?a(t,r,b,y,x,S,O):"coastalrelief"==A?n(t,r,b,y,x,S,O):i(t,r,b,y,x,S,O)}function i(t,i,a,n,s,l,c){var g=new e.RGB(127,130,146),d=new e.RGB(0,30,30),f=new e.RGB(243,226,194),p=new e.RGB(208,177,120),m=Math.round(204),u=Math.round(153),w=Math.round(51),v=r(t,a,l,c),y=v.getContext("2d"),x=v.width,S=v.height,O=a,I=Math.round(h*i.width/8),M=3200/t.MapRange;M>3&&(M=3),I*=M,stackBlurCanvasRGB(O,0,0,O.width,O.height,I);var b,C=O.getContext("2d").getImageData(0,0,O.width,O.height).data,A=y.getImageData(0,0,x,S),T=A.data,L=new Array(256),D=new Array(256),B=new Array(256);for(b=0;b<L.length;b++){var R=b/255,E=g.Blend(f,R),N=.5/M;N<.5?N=.5:N>.7&&(N=.7),R<=N&&(E=E.Blend(d,.5-.5*R/N)),L[b]=E.R,D[b]=E.G,B[b]=E.B}var F=p.R,U=p.G,k=p.B,G=4*O.width/x,H=4*O.width*(O.height/S-1),$=0,_=0,P=0,j=0;for(_=0;_<S;_++){for($=0;$<x;$++){var z,W=C[j],X=T[P]>128&&W>75;if(X)z=w,T[P]=F,T[P+1]=U,T[P+2]=k;else{var V=(255-W)/255;z=Math.round(m*(1-V)+u*V);var Z=Math.round(.7*(255-W));Z>255&&(Z=255),Z<0&&(Z=0),T[P]=L[Z],T[P+1]=D[Z],T[P+2]=B[Z]}T[P+3]=z,P+=4,j+=G}j+=H}y.putImageData(A,0,0);var J=e.cloneCanvas(i),Q=J.getContext("2d");return Q.drawImage(v,0,0,x,S,n,s,l,c),o(J,i,1,1)}function a(t,i,a,n,s,l,c){var g=new e.RGB(144,104,67),d=new e.RGB(249,232,206),f=Math.round(178.5),p=Math.round(51),m=Math.round(63.75),u=r(t,a,l,c),w=u.getContext("2d"),v=u.width,y=u.height,x=a,S=Math.round(h*i.width/8),O=3200/t.MapRange;O>3&&(O=3),S*=O,stackBlurCanvasRGB(x,0,0,x.width,x.height,S);var I=x.getContext("2d").getImageData(0,0,x.width,x.height).data,M=w.getImageData(0,0,v,y),b=M.data,C=d.R,A=d.G,T=d.B,L=g.R,D=g.G,B=g.B,R=4*x.width/v,E=4*x.width*(x.height/y-1),N=0,F=0,U=0,k=0;for(F=0;F<y;F++){for(N=0;N<v;N++){var G,H=I[k],$=b[U]>128&&H>75;$?(G=m,b[U]=C,b[U+1]=A,b[U+2]=T):(G=Math.round(H*(f-p)/255)+p,b[U]=L,b[U+1]=D,b[U+2]=B),b[U+3]=G,U+=4,k+=R}k+=E}w.putImageData(M,0,0);var _=e.cloneCanvas(i),P=_.getContext("2d");return P.drawImage(u,0,0,v,y,n,s,l,c),o(_,i,1,1)}function n(t,i,a,n,s,c,g){var d=new e.RGB(144,104,67),f=d.Blend(l,.45),p=r(t,a,c,g),m=p.getContext("2d"),u=p.width,w=p.height,v=a,y=Math.round(h*i.width/20);stackBlurCanvasRGB(v,0,0,v.width,v.height,y);var x=v.getContext("2d").getImageData(0,0,v.width,v.height).data,S=m.getImageData(0,0,u,w),O=S.data,I=f.R,M=f.G,b=f.B,C=4*v.width/u,A=4*v.width*(v.height/w-1),T=0,L=0,D=0,B=0;for(L=0;L<w;L++){for(T=0;T<u;T++){var R=255-O[D],E=x[B];O[D]=I,O[D+1]=M,O[D+2]=b,O[D+3]=R<E?R:E,D+=4,B+=C}B+=A}m.putImageData(S,0,0);var N=e.cloneCanvas(i),F=N.getContext("2d");return F.drawImage(p,0,0,u,w,n,s,c,g),o(N,i,1,0)}function r(t,i,a,n){i.width%a==0&&i.height%n==0&&i.width/a==h||alert("CreateWorkingCanvas called with transformedOceanMask_Canvas size not a multiple of output size");var r=document.createElement("canvas");if(t.HardCoastlines){r.width=a,r.height=n;var o=r.getContext("2d");o.drawImage(i,0,0,i.width,i.height,0,0,a,n)}else r=e.cloneCanvas(i);return r}function o(t,i,a,n,r){void 0===a&&(a=2),void 0===n&&(n=4),void 0===r&&(r=0);var o=e.cloneCanvas(i),s=o.getContext("2d"),h=s.getImageData(0,0,o.width,o.height),l=h.data,c=t.getContext("2d"),g=c.getImageData(0,0,t.width,t.height),d=g.data,f=new Array(o.width),p=0;for(p=0;p<f.length;p++)f[p]=255;for(p=0;p<a;p++)f[p]=r,f[f.length-(p+1)]=r;for(p=0;p<n;p++){var m=r+Math.round((255-r)*(p+1)/(n+1));f[p+a]=m,f[f.length-(p+1+a)]=m}var u,w,v,y=0,x=0,S=0,O=!1;for(x=0;x<o.height;x++){var I=f[x];for(y=0;y<o.width;y++){if(0==l[S+3])d[S+3]=0;else if(O)if(l[S]==u&&l[S+1]==w&&l[S+2]==v)d[S+3]=0;else{var M=f[y],b=M<I?M:I;d[S+3]=b}else O=!0,u=l[S],w=l[S+1],v=l[S+2],d[S+3]=0;S+=4}}return c.putImageData(g,0,0),s.drawImage(t,0,0),o}var s=16,h=4,l=new e.RGB(0,0,0);new e.RGB(255,255,255);e.renderOcean=t}(MinecraftMap||(MinecraftMap={}));var MinecraftMap;!function(e){"use strict";function t(t,i,a,n){function r(n,r){return function(){e.createMapImageInDiv(n,a[n].divName,a[n].width,a[n].height,t,i,function(){r.resolve()})}}e.PreRender(t);var o,s=[];for(o=0;o<a.length;o++){var h=$.Deferred();setTimeout(r(o,h),1),s[o]=h}$.when.apply($,s).done(n)}function i(t,i,a){function n(e){document.title=e.Title,$("#mainTitle").text(e.Title),$("#tagline").text(e.Blurb)}function r(t,i,a){if(e.isString(t)){var n=new RegExp(".txt$|.csv$","i"),r=n.test(t);$.ajax({url:t,dataType:r?"text":"html",success:function(t,i,n){var o=n.getResponseHeader("content-type")||"";o.indexOf("text/plain")>=0||o.indexOf("text/csv")>=0||r?e.parseTextLocations(t,a):e.parseHtmlLocations(t,a)},error:function(a,n,r){t==e.gMapDataUriDefault?alert('no "src=" url was specified to scrape the location data from.\n\n(and could not load from the fallback url)'):i?alert('Failed to load locations from src "'+t+'"\nThis might be a Google Doc file instead of a txt file on Google Drive.\n\nThe map viewer cannot read Doc format.'):alert('Failed to load locations from src "'+t+'", something went wrong: '+n+", "+r)}})}else alert("Internal error: dataUrl not string")}function o(t,i){var a=h(t.OceanMapUri,i?"oceanmask":"","OceanMap");return e.gOceanMapImage=a.image,a.waitObj}function s(t,i){var a=h(t.CustomIconsUri,i?"customtileset":"","Custom-icons");return e.gCustomIcons=a.image,a.waitObj}function h(t,i,a){var n={image:null,waitObj:$.Deferred()};if(e.isEmpty(t))e.isNotEmptyString(i)?(n.image=document.getElementById(i),null!=n.image?e.isImageOk(n.image)?n.waitObj.resolve():(n.image=null,n.waitObj=null):n.waitObj=null):n.waitObj=null;else{n.image=new Image;var r=function(){n.waitObj.resolve()},o=function(e){n.image=null,n.waitObj.resolve();var i="Could not load "+a+' image at "'+t+'"';alert(i),console.log(i+", useless error information follows: "+JSON.stringify(e))};jQuery(n.image).on("load",r).on("error",o),n.image.crossOrigin="anonymous";try{n.image.src=t,n.image.complete&&r()}catch(e){console.log("Failed to load img: "+JSON.stringify(e))}}return n}var l=new e.MapConfiguration;l.AssignFromUrl(location.toString());var c=o(l,!1),g=s(l,!1),d="MapDataUri"in l?l.MapDataUri:e.gMapDataUriDefault;e.isNotEmptyString(d)?r(d,l.GoogleSrcLooksLikeDoc===!0,function(r,h){var d=new e.MapConfiguration;d.SetDefaults(t,i),d.AssignFrom(r),d.AssignFrom(l),n(d);var f=[];null==c&&(c=o(d,!0)),null!=c&&f.push(c),null==g&&(g=s(d,!0)),null!=g&&f.push(g),$.when.apply($,f).done(function(){a(d,h)})}):l.MissingSrcMessageDisplayed||alert('no "src=" url was specified to scrape the location data from.')}e.cMapRangeDefault=3200,e.cClickRadius=12,e.cCaptionSpacer_vertical=8,e.cLabel_DontDrawChar="~",e.cLabel_AlwaysDrawChar="!",e.cCustomIconIndexStart=64,e.cShowBoundingBoxes=!1,e.gMapDataUriDefault="",e.gHrefTargetDefault="",e.gCustomIcons=null,e.gOceanMapImage=null,e.gLocationIconScale=1,e.gLocationFontScale=1,e.createMapsInDivs_Async=t,e.getSettingsAndMapLocations=i}(MinecraftMap||(MinecraftMap={}));
//# sourceMappingURL=minecraftmap.min.js.map